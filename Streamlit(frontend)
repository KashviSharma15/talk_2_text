# streamlit_frontend.py
import streamlit as st
import requests
from io import BytesIO

# ğŸš€ Title and style
st.set_page_config(page_title="Talk2Text", layout="centered")
st.markdown("<h1 style='text-align: center; color: #4B8BBE;'>ğŸ™ Talk2Text - Audio to Text</h1>", unsafe_allow_html=True)

st.markdown("###")

# ğŸ“ File uploader
uploaded_file = st.file_uploader("Upload an audio file (WAV, MP3, etc.)", type=["wav", "mp3", "m4a"])

# ğŸŒ API URL
API_URL = "http://localhost:8000/transcribe/"  # Or your Ngrok URL if deployed

# â–¶ Button to trigger transcription
if uploaded_file is not None:
    if st.button("Transcribe"):
        st.info("Transcribing, please wait...")
        try:
            # Send the file to FastAPI
            files = {"file": (uploaded_file.name, uploaded_file, uploaded_file.type)}
            response = requests.post(API_URL, files=files)

            if response.status_code == 200:
                text = response.json().get("text", "")
                st.success("Transcription complete!")
                st.text_area("ğŸ“ Transcribed Text:", text, height=300)
            else:
                st.error(f"Failed to transcribe. Status: {response.status_code}")
        except Exception as e:
            st.error(f"Error: {str(e)}")
else:
    st.markdown("â¬† Upload an audio file to get started.")

# âœ¨ Footer
st.markdown("<hr><center>Made with FastAPI, Whisper & Streamlit</center>", unsafe_allow_html=True)
